<!DOCTYPE html>
<html lang="tr"><head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  
    <meta name="description" content="Bu yazÄ±da, eBPF CO-RE desteÄŸi ile taÅŸÄ±nabilir bir trafik analiz uygulamasÄ± geliÅŸtireceÄŸiz.">
  

  
    <meta property="og:image" content="/assets/images/bpf-core-network-analysis.png" />
  
  <meta property="og:site_name" content="blog" />
  <meta property="og:title" content="blog" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://msrexe.github.io" />

  <title>BPF GÃ¼nlÃ¼kleri: Packet Counter'dan Trafik Analizine â€“ BPF CO-RE ile GeliÅŸmiÅŸ Uygulamalar</title><!-- Begin Jekyll SEO tag v2.7.1 -->
<meta name="generator" content="Jekyll v3.9.5" />
<meta property="og:title" content="BPF GÃ¼nlÃ¼kleri: Packet Counterâ€™dan Trafik Analizine â€“ BPF CO-RE ile GeliÅŸmiÅŸ Uygulamalar" />
<meta name="author" content="msrexe" />
<meta property="og:locale" content="tr" />
<meta name="description" content="Bu yazÄ±da, eBPF CO-RE desteÄŸi ile taÅŸÄ±nabilir bir trafik analiz uygulamasÄ± geliÅŸtireceÄŸiz." />
<meta property="og:description" content="Bu yazÄ±da, eBPF CO-RE desteÄŸi ile taÅŸÄ±nabilir bir trafik analiz uygulamasÄ± geliÅŸtireceÄŸiz." />
<link rel="canonical" href="https://msrexe.github.io/bpf-core-ile-trafik-analizi.html" />
<meta property="og:url" content="https://msrexe.github.io/bpf-core-ile-trafik-analizi.html" />
<meta property="og:site_name" content="blog" />
<meta property="og:image" content="https://msrexe.github.io/assets/images/bpf-core-network-analysis.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-06-16T00:00:00+03:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://msrexe.github.io/assets/images/bpf-core-network-analysis.png" />
<meta property="twitter:title" content="BPF GÃ¼nlÃ¼kleri: Packet Counterâ€™dan Trafik Analizine â€“ BPF CO-RE ile GeliÅŸmiÅŸ Uygulamalar" />
<script type="application/ld+json">
{"url":"https://msrexe.github.io/bpf-core-ile-trafik-analizi.html","headline":"BPF GÃ¼nlÃ¼kleri: Packet Counterâ€™dan Trafik Analizine â€“ BPF CO-RE ile GeliÅŸmiÅŸ Uygulamalar","dateModified":"2025-06-16T00:00:00+03:00","datePublished":"2025-06-16T00:00:00+03:00","author":{"@type":"Person","name":"msrexe"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://msrexe.github.io/bpf-core-ile-trafik-analizi.html"},"description":"Bu yazÄ±da, eBPF CO-RE desteÄŸi ile taÅŸÄ±nabilir bir trafik analiz uygulamasÄ± geliÅŸtireceÄŸiz.","@type":"BlogPosting","image":"https://msrexe.github.io/assets/images/bpf-core-network-analysis.png","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link type="application/atom+xml" rel="alternate" href="https://msrexe.github.io/feed.xml" title="blog" /><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
  
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
  
  <link rel="stylesheet" href="/assets/css/main.css" />
</head>
<body a="dark">
    <main class="page-content" aria-label="Content">
      <div class="w">
        <div class="back-link"><a href="/">â† Home</a></div>

<article>
  <h1>BPF GÃ¼nlÃ¼kleri: Packet Counter'dan Trafik Analizine â€“ BPF CO-RE ile GeliÅŸmiÅŸ Uygulamalar</h1><p class="post-meta">
    <time datetime="2025-06-16 00:00:00 +0300">June 16, 2025</time>
    <span class="read-time">ğŸ“– 6 min read</span><span class="lang-tag">ğŸŒ TR</span><span class="category">linux</span></p><p class="post-description">Bu yazÄ±da, eBPF CO-RE desteÄŸi ile taÅŸÄ±nabilir bir trafik analiz uygulamasÄ± geliÅŸtireceÄŸiz.</p><p><img src="assets/images/bpf-core-network-analysis.png" alt="Image" /></p>

<p>Bir Ã¶nceki yazÄ±da, eBPF mimarisini kullanarak temel bir <strong>packet counter</strong> uygulamasÄ± geliÅŸtirmiÅŸtik. Ancak klasik yÃ¶ntemle yazÄ±lmÄ±ÅŸ bu eBPF programlarÄ±, kernel versiyonlarÄ±na gÃ¶re farklÄ±lÄ±k gÃ¶steren <code class="language-plaintext highlighter-rouge">linux/bpf.h</code> gibi baÄŸÄ±mlÄ±lÄ±klara sahipti. Bu da taÅŸÄ±nabilirliÄŸi oldukÃ§a azaltÄ±yor ve farklÄ± linux Ã§ekirdeklerinde kernellarÄ±nda Ã§alÄ±ÅŸtÄ±rmayÄ± zorlaÅŸtÄ±rÄ±yordu.</p>

<p>Ä°ÅŸte bu yazÄ±da, <strong>CO-RE (Compile Once â€“ Run Everywhere)</strong> Ã¶zelliÄŸini kullanarak farklÄ± sistemlerde Ã§alÄ±ÅŸabilen bir trafik analiz uygulamasÄ± yazacaÄŸÄ±z. Hedefimiz gelen paketlerin kaynak IP adreslerine gÃ¶re sÄ±nÄ±flandÄ±rÄ±lmasÄ± ve yoÄŸunluk analizi olacak.</p>

<hr />

<h2 id="gereksinimler">Gereksinimler</h2>

<ul>
  <li>Linux 5.8+ (BTF desteÄŸi iÃ§in)</li>
  <li><code class="language-plaintext highlighter-rouge">bpftool</code> (vmlinux.h Ã¼retimi iÃ§in)</li>
  <li>Clang &amp; LLVM (11+)</li>
  <li>Go</li>
  <li><a href="https://github.com/libbpf/libbpf">libbpf</a></li>
  <li><a href="https://github.com/cilium/ebpf">cilium/ebpf</a></li>
</ul>

<hr />

<h2 id="1-bpf-co-re-nedir">1. BPF CO-RE Nedir?</h2>

<p><strong>CO-RE</strong>, eBPF programlarÄ±nÄ± bir kere derleyip farklÄ± Linux Ã§ekirdek sÃ¼rÃ¼mlerinde Ã§alÄ±ÅŸtÄ±rmamÄ±za olanak tanÄ±r. Bunu Ã§ekirdeÄŸin kendi tÃ¼r tanÄ±mlarÄ±na eriÅŸerek (<code class="language-plaintext highlighter-rouge">BTF</code>) yapar. Bu ÅŸekilde <code class="language-plaintext highlighter-rouge">linux/bpf.h</code> gibi dÄ±ÅŸ baÄŸÄ±mlÄ±lÄ±klardan kurtuluruz.</p>

<hr />

<h2 id="2-c-ile-ebpf-programÄ±-ip-sayaÃ§">2. C ile eBPF ProgramÄ±: IP SayaÃ§</h2>

<p><code class="language-plaintext highlighter-rouge">ip_counter.bpf.c</code> dosyasÄ±nÄ± aÅŸaÄŸÄ±daki gibi oluÅŸturun:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">"vmlinux.h"</span><span class="cp">
#include</span> <span class="cpf">&lt;bpf/bpf_helpers.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;bpf/bpf_endian.h&gt;</span><span class="cp">
</span>
<span class="kt">char</span> <span class="n">LICENSE</span><span class="p">[]</span> <span class="n">SEC</span><span class="p">(</span><span class="s">"license"</span><span class="p">)</span> <span class="o">=</span> <span class="s">"Dual MIT/GPL"</span><span class="p">;</span>

<span class="k">struct</span> <span class="p">{</span>
    <span class="n">__uint</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="n">BPF_MAP_TYPE_HASH</span><span class="p">);</span>
    <span class="n">__type</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">__u32</span><span class="p">);</span>
    <span class="n">__type</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">__u64</span><span class="p">);</span>
    <span class="n">__uint</span><span class="p">(</span><span class="n">max_entries</span><span class="p">,</span> <span class="mi">1024</span><span class="p">);</span>
<span class="p">}</span> <span class="n">ip_count</span> <span class="nf">SEC</span><span class="p">(</span><span class="s">".maps"</span><span class="p">);</span>

<span class="n">SEC</span><span class="p">(</span><span class="s">"xdp"</span><span class="p">)</span>
<span class="kt">int</span> <span class="nf">count_src_ips</span><span class="p">(</span><span class="k">struct</span> <span class="n">xdp_md</span> <span class="o">*</span><span class="n">ctx</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">void</span> <span class="o">*</span><span class="n">data_end</span> <span class="o">=</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)(</span><span class="kt">long</span><span class="p">)</span><span class="n">ctx</span><span class="o">-&gt;</span><span class="n">data_end</span><span class="p">;</span>
    <span class="kt">void</span> <span class="o">*</span><span class="n">data</span>     <span class="o">=</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)(</span><span class="kt">long</span><span class="p">)</span><span class="n">ctx</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">;</span>

    <span class="k">struct</span> <span class="n">ethhdr</span> <span class="o">*</span><span class="n">eth</span> <span class="o">=</span> <span class="n">data</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">((</span><span class="kt">void</span><span class="o">*</span><span class="p">)(</span><span class="n">eth</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">data_end</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">XDP_PASS</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">eth</span><span class="o">-&gt;</span><span class="n">h_proto</span> <span class="o">!=</span> <span class="n">__bpf_htons</span><span class="p">(</span><span class="n">ETH_P_IP</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">XDP_PASS</span><span class="p">;</span>

    <span class="k">struct</span> <span class="n">iphdr</span> <span class="o">*</span><span class="n">iph</span> <span class="o">=</span> <span class="p">(</span><span class="kt">void</span><span class="o">*</span><span class="p">)(</span><span class="n">eth</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">((</span><span class="kt">void</span><span class="o">*</span><span class="p">)(</span><span class="n">iph</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">data_end</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">XDP_PASS</span><span class="p">;</span>

    <span class="n">__u32</span> <span class="n">src_ip</span> <span class="o">=</span> <span class="n">bpf_ntohl</span><span class="p">(</span><span class="n">iph</span><span class="o">-&gt;</span><span class="n">saddr</span><span class="p">);</span>

    <span class="n">__u64</span> <span class="o">*</span><span class="n">count</span> <span class="o">=</span> <span class="n">bpf_map_lookup_elem</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ip_count</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">src_ip</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">count</span><span class="p">)</span>
        <span class="n">__sync_fetch_and_add</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="n">__u64</span> <span class="n">init_val</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="n">bpf_map_update_elem</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ip_count</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">src_ip</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">init_val</span><span class="p">,</span> <span class="n">BPF_ANY</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">XDP_PASS</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">vmlinux.h</code> dosyasÄ±nÄ± ÅŸu komutla oluÅŸturabilirsiniz:</p>
  <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="sb">`</span>bpftool btf dump file /sys/kernel/btf/vmlinux format c <span class="o">&gt;</span> vmlinux.h<span class="sb">`</span>
</code></pre></div>  </div>
</blockquote>

<hr />

<h2 id="3-go-ile-kernela-yÃ¼kleme-ve-izleme">3. Go ile kernelâ€™a yÃ¼kleme ve izleme</h2>

<p><code class="language-plaintext highlighter-rouge">main.go</code> dosyasÄ±nÄ± ÅŸu ÅŸekilde yazalÄ±m:</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="p">(</span>
    <span class="s">"encoding/binary"</span>
    <span class="s">"fmt"</span>
    <span class="s">"log"</span>
    <span class="s">"net"</span>
    <span class="s">"os"</span>
    <span class="s">"os/signal"</span>
    <span class="s">"time"</span>

    <span class="s">"github.com/cilium/ebpf"</span>
    <span class="s">"github.com/cilium/ebpf/link"</span>
    <span class="s">"github.com/cilium/ebpf/rlimit"</span>
<span class="p">)</span>

<span class="k">func</span> <span class="n">ipToStr</span><span class="p">(</span><span class="n">ip</span> <span class="kt">uint32</span><span class="p">)</span> <span class="kt">string</span> <span class="p">{</span>
    <span class="n">bytes</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">([]</span><span class="kt">byte</span><span class="p">,</span> <span class="m">4</span><span class="p">)</span>
    <span class="n">binary</span><span class="o">.</span><span class="n">BigEndian</span><span class="o">.</span><span class="n">PutUint32</span><span class="p">(</span><span class="n">bytes</span><span class="p">,</span> <span class="n">ip</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">net</span><span class="o">.</span><span class="n">IP</span><span class="p">(</span><span class="n">bytes</span><span class="p">)</span><span class="o">.</span><span class="n">String</span><span class="p">()</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">rlimit</span><span class="o">.</span><span class="n">RemoveMemlock</span><span class="p">();</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="n">log</span><span class="o">.</span><span class="n">Fatalf</span><span class="p">(</span><span class="s">"Removing memlock: %v"</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="n">spec</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">ebpf</span><span class="o">.</span><span class="n">LoadCollectionSpec</span><span class="p">(</span><span class="s">"ip_counter.bpf.o"</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="n">log</span><span class="o">.</span><span class="n">Fatalf</span><span class="p">(</span><span class="s">"Loading collection spec: %v"</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="n">objs</span> <span class="o">:=</span> <span class="k">struct</span> <span class="p">{</span>
        <span class="n">Program</span>  <span class="o">*</span><span class="n">ebpf</span><span class="o">.</span><span class="n">Program</span> <span class="s">`ebpf:"count_src_ips"`</span>
        <span class="n">IpCount</span>  <span class="o">*</span><span class="n">ebpf</span><span class="o">.</span><span class="n">Map</span>     <span class="s">`ebpf:"ip_count"`</span>
    <span class="p">}{}</span>

    <span class="k">if</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">spec</span><span class="o">.</span><span class="n">LoadAndAssign</span><span class="p">(</span><span class="o">&amp;</span><span class="n">objs</span><span class="p">,</span> <span class="no">nil</span><span class="p">);</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="n">log</span><span class="o">.</span><span class="n">Fatalf</span><span class="p">(</span><span class="s">"Loading and assigning: %v"</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">defer</span> <span class="n">objs</span><span class="o">.</span><span class="n">Program</span><span class="o">.</span><span class="n">Close</span><span class="p">()</span>
    <span class="k">defer</span> <span class="n">objs</span><span class="o">.</span><span class="n">IpCount</span><span class="o">.</span><span class="n">Close</span><span class="p">()</span>

    <span class="n">ifaceName</span> <span class="o">:=</span> <span class="s">"eth0"</span>
    <span class="n">iface</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">net</span><span class="o">.</span><span class="n">InterfaceByName</span><span class="p">(</span><span class="n">ifaceName</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="n">log</span><span class="o">.</span><span class="n">Fatalf</span><span class="p">(</span><span class="s">"Getting interface %s: %v"</span><span class="p">,</span> <span class="n">ifaceName</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="n">l</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">link</span><span class="o">.</span><span class="n">AttachXDP</span><span class="p">(</span><span class="n">link</span><span class="o">.</span><span class="n">XDPOptions</span><span class="p">{</span>
        <span class="n">Program</span><span class="o">:</span>   <span class="n">objs</span><span class="o">.</span><span class="n">Program</span><span class="p">,</span>
        <span class="n">Interface</span><span class="o">:</span> <span class="n">iface</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span>
    <span class="p">})</span>
    <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="n">log</span><span class="o">.</span><span class="n">Fatalf</span><span class="p">(</span><span class="s">"Attaching XDP: %v"</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">defer</span> <span class="n">l</span><span class="o">.</span><span class="n">Close</span><span class="p">()</span>

    <span class="n">log</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"Tracking source IPs on %s..."</span><span class="p">,</span> <span class="n">ifaceName</span><span class="p">)</span>

    <span class="n">ticker</span> <span class="o">:=</span> <span class="n">time</span><span class="o">.</span><span class="n">NewTicker</span><span class="p">(</span><span class="m">2</span> <span class="o">*</span> <span class="n">time</span><span class="o">.</span><span class="n">Second</span><span class="p">)</span>
    <span class="n">stop</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="k">chan</span> <span class="n">os</span><span class="o">.</span><span class="n">Signal</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
    <span class="n">signal</span><span class="o">.</span><span class="n">Notify</span><span class="p">(</span><span class="n">stop</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">Interrupt</span><span class="p">)</span>

    <span class="k">for</span> <span class="p">{</span>
        <span class="k">select</span> <span class="p">{</span>
        <span class="k">case</span> <span class="o">&lt;-</span><span class="n">ticker</span><span class="o">.</span><span class="n">C</span><span class="o">:</span>
            <span class="k">var</span> <span class="n">ip</span> <span class="kt">uint32</span>
            <span class="k">var</span> <span class="n">count</span> <span class="kt">uint64</span>
            <span class="n">iter</span> <span class="o">:=</span> <span class="n">objs</span><span class="o">.</span><span class="n">IpCount</span><span class="o">.</span><span class="n">Iterate</span><span class="p">()</span>
            <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"Top Source IPs:"</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">iter</span><span class="o">.</span><span class="n">Next</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ip</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">count</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"  %s =&gt; %d packets</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">ipToStr</span><span class="p">(</span><span class="n">ip</span><span class="p">),</span> <span class="n">count</span><span class="p">)</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">iter</span><span class="o">.</span><span class="n">Err</span><span class="p">();</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
                <span class="n">log</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"Error iterating map: %v"</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="k">case</span> <span class="o">&lt;-</span><span class="n">stop</span><span class="o">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"Exiting.."</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<hr />

<h2 id="4-derleme-ve-Ã§alÄ±ÅŸtÄ±rma">4. Derleme ve Ã‡alÄ±ÅŸtÄ±rma</h2>

<h3 id="c-kodunu-derleme">C Kodunu Derleme</h3>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>clang <span class="nt">-O2</span> <span class="nt">-g</span> <span class="nt">-target</span> bpf <span class="nt">-D__TARGET_ARCH_x86</span> <span class="nt">-I</span><span class="nb">.</span> <span class="nt">-c</span> ip_counter.bpf.c <span class="nt">-o</span> ip_counter.bpf.o
</code></pre></div></div>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">-I.</code> parametresi ile bulunduÄŸunuz klasÃ¶rdeki <code class="language-plaintext highlighter-rouge">vmlinux.h</code> dosyasÄ±nÄ± da eklemeyi unutmayÄ±n.</p>
</blockquote>

<h3 id="go-kodunu-Ã§alÄ±ÅŸtÄ±rma">Go kodunu Ã§alÄ±ÅŸtÄ±rma</h3>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>go mod init ip-analyzer
go mod tidy
go run main.go
</code></pre></div></div>

<hr />

<h2 id="Ã¶rnek-Ã§Ä±ktÄ±">Ã–rnek Ã§Ä±ktÄ±</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>2025/06/16 21:45:00 Tracking source IPs on eth0...
Top Source IPs:
  192.168.1.101 =&gt; 15 packets
  10.0.0.5      =&gt; 7 packets
  8.8.8.8       =&gt; 2 packets
</code></pre></div></div>

<hr />

<h2 id="sonuÃ§">SonuÃ§</h2>

<p>Bu yazÄ±da, <strong>CO-RE</strong> desteÄŸi ile yazÄ±lmÄ±ÅŸ taÅŸÄ±nabilir bir eBPF uygulamasÄ± geliÅŸtirdik. Packet counter uygulamasÄ±nÄ± bir adÄ±m ileri taÅŸÄ±yarak, <strong>kaynak IP adreslerine gÃ¶re trafik analizi</strong> gerÃ§ekleÅŸtirdik.</p>

<p>Bu yapÄ± sayesinde artÄ±k kernel headerâ€™larÄ±nÄ± elle ayarlamaya gerek kalmadan, farklÄ± sistemlerde Ã§alÄ±ÅŸabilen bir analiz aracÄ± elde ettik.</p>

<p>Bir sonraki yazÄ±da, eBPF Ã¼zerine Ã¶ÄŸrendiÄŸim yeni ÅŸeyleri paylaÅŸacaÄŸÄ±m. Åimdilik esenlikle kalÄ±n..</p>
</article>
      </div>
    </main>
    
    <!-- Post filter script -->
    <script type="text/javascript" src="/assets/js/post-filter.js"></script>
  </body>
</html>